using Interpolations
using Jutul
function computeOCPanodeDLR2(c, T, cmax)
    # Concentration normalisée
    stoc = c / cmax

    # Table de données 
    stoc_vals = [4.35231322e-04
                2.43749685e-03
                4.43976238e-03
                6.44202790e-03
                8.44429343e-03
                1.04465590e-02
                1.24488245e-02
                1.44510900e-02
                1.64533555e-02
                1.84556211e-02
                2.04578866e-02
                2.24601521e-02
                2.44624177e-02
                2.64646832e-02
                2.84669487e-02
                3.04692142e-02
                3.24714798e-02
                3.44737453e-02
                3.64760108e-02
                3.84782763e-02
                4.04805419e-02
                4.24828074e-02
                4.44850729e-02
                4.64873385e-02
                4.84896040e-02
                5.04918695e-02
                5.24941350e-02
                5.44964006e-02
                5.64986661e-02
                5.85009316e-02
                6.05031971e-02
                6.25054627e-02
                6.45077282e-02
                6.65099937e-02
                6.85122593e-02
                7.05145248e-02
                7.25167903e-02
                7.45190558e-02
                7.65213214e-02
                7.85235869e-02
                8.05258524e-02
                8.25281179e-02
                8.45303835e-02
                8.65326490e-02
                8.85349145e-02
                9.05371801e-02
                9.25394456e-02
                9.45417111e-02
                9.65439766e-02
                9.85462422e-02
                1.00548508e-01
                1.02550773e-01
                1.04553039e-01
                1.06555304e-01
                1.08557570e-01
                1.10559835e-01
                1.12562101e-01
                1.14564366e-01
                1.16566632e-01
                1.18568897e-01
                1.20571163e-01
                1.22573428e-01
                1.24575694e-01
                1.26577960e-01
                1.28580225e-01
                1.30582491e-01
                1.32584756e-01
                1.34587022e-01
                1.36589287e-01
                1.38591553e-01
                1.40593818e-01
                1.42596084e-01
                1.44598349e-01
                1.46600615e-01
                1.48602880e-01
                1.50605146e-01
                1.52607411e-01
                1.54609677e-01
                1.56611942e-01
                1.58614208e-01
                1.60616474e-01
                1.62618739e-01
                1.64621005e-01
                1.66623270e-01
                1.68625536e-01
                1.70627801e-01
                1.72630067e-01
                1.74632332e-01
                1.76634598e-01
                1.78636863e-01
                1.80639129e-01
                1.82641394e-01
                1.84643660e-01
                1.86645925e-01
                1.88648191e-01
                1.90650456e-01
                1.92652722e-01
                1.94654987e-01
                1.96657253e-01
                1.98659519e-01
                2.00661784e-01
                2.02664050e-01
                2.04666315e-01
                2.06668581e-01
                2.08670846e-01
                2.10673112e-01
                2.12675377e-01
                2.14677643e-01
                2.16679908e-01
                2.18682174e-01
                2.20684439e-01
                2.22686705e-01
                2.24688970e-01
                2.26691236e-01
                2.28693501e-01
                2.30695767e-01
                2.32698033e-01
                2.34700298e-01
                2.36702564e-01
                2.38704829e-01
                2.40707095e-01
                2.42709360e-01
                2.44711626e-01
                2.46713891e-01
                2.48716157e-01
                2.50718422e-01
                2.52720688e-01
                2.54722953e-01
                2.56725219e-01
                2.58727484e-01
                2.60729750e-01
                2.62732015e-01
                2.64734281e-01
                2.66736546e-01
                2.68738812e-01
                2.70741078e-01
                2.72743343e-01
                2.74745609e-01
                2.76747874e-01
                2.78750140e-01
                2.80752405e-01
                2.82754671e-01
                2.84756936e-01
                2.86759202e-01
                2.88761467e-01
                2.90763733e-01
                2.92765998e-01
                2.94768264e-01
                2.96770529e-01
                2.98772795e-01
                3.00775060e-01
                3.02777326e-01
                3.04779591e-01
                3.06781857e-01
                3.08784123e-01
                3.10786388e-01
                3.12788654e-01
                3.14790919e-01
                3.16793185e-01
                3.18795450e-01
                3.20797716e-01
                3.22799981e-01
                3.24802247e-01
                3.26804512e-01
                3.28806778e-01
                3.30809043e-01
                3.32811309e-01
                3.34813574e-01
                3.36815840e-01
                3.38818105e-01
                3.40820371e-01
                3.42822637e-01
                3.44824902e-01
                3.46827168e-01
                3.48829433e-01
                3.50831699e-01
                3.52833964e-01
                3.54836230e-01
                3.56838495e-01
                3.58840761e-01
                3.60843026e-01
                3.62845292e-01
                3.64847557e-01
                3.66849823e-01
                3.68852088e-01
                3.70854354e-01
                3.72856619e-01
                3.74858885e-01
                3.76861150e-01
                3.78863416e-01
                3.80865682e-01
                3.82867947e-01
                3.84870213e-01
                3.86872478e-01
                3.88874744e-01
                3.90877009e-01
                3.92879275e-01
                3.94881540e-01
                3.96883806e-01
                3.98886071e-01
                4.00888337e-01
                4.02890602e-01
                4.04892868e-01
                4.06895133e-01
                4.08897399e-01
                4.10899664e-01
                4.12901930e-01
                4.14904196e-01
                4.16906461e-01
                4.18908727e-01
                4.20910992e-01
                4.22913258e-01
                4.24915523e-01
                4.26917789e-01
                4.28920054e-01
                4.30922320e-01
                4.32924585e-01
                4.34926851e-01
                4.36929116e-01
                4.38931382e-01
                4.40933647e-01
                4.42935913e-01
                4.44938178e-01
                4.46940444e-01
                4.48942709e-01
                4.50944975e-01
                4.52947241e-01
                4.54949506e-01
                4.56951772e-01
                4.58954037e-01
                4.60956303e-01
                4.62958568e-01
                4.64960834e-01
                4.66963099e-01
                4.68965365e-01
                4.70967630e-01
                4.72969896e-01
                4.74972161e-01
                4.76974427e-01
                4.78976692e-01
                4.80978958e-01
                4.82981223e-01
                4.84983489e-01
                4.86985754e-01
                4.88988020e-01
                4.90990286e-01
                4.92992551e-01
                4.94994817e-01
                4.96997082e-01
                4.98999348e-01
                5.01001613e-01
                5.03003879e-01
                5.05006144e-01
                5.07008410e-01
                5.09010675e-01
                5.11012941e-01
                5.13015206e-01
                5.15017472e-01
                5.17019737e-01
                5.19022003e-01
                5.21024268e-01
                5.23026534e-01
                5.25028800e-01
                5.27031065e-01
                5.29033331e-01
                5.31035596e-01
                5.33037862e-01
                5.35040127e-01
                5.37042393e-01
                5.39044658e-01
                5.41046924e-01
                5.43049189e-01
                5.45051455e-01
                5.47053720e-01
                5.49055986e-01
                5.51058251e-01
                5.53060517e-01
                5.55062782e-01
                5.57065048e-01
                5.59067313e-01
                5.61069579e-01
                5.63071845e-01
                5.65074110e-01
                5.67076376e-01
                5.69078641e-01
                5.71080907e-01
                5.73083172e-01
                5.75085438e-01
                5.77087703e-01
                5.79089969e-01
                5.81092234e-01
                5.83094500e-01
                5.85096765e-01
                5.87099031e-01
                5.89101296e-01
                5.91103562e-01
                5.93105827e-01
                5.95108093e-01
                5.97110359e-01
                5.99112624e-01
                6.01114890e-01
                6.03117155e-01
                6.05119421e-01
                6.07121686e-01
                6.09123952e-01
                6.11126217e-01
                6.13128483e-01
                6.15130748e-01
                6.17133014e-01
                6.19135279e-01
                6.21137545e-01
                6.23139810e-01
                6.25142076e-01
                6.27144341e-01
                6.29146607e-01
                6.31148872e-01
                6.33151138e-01
                6.35153404e-01
                6.37155669e-01
                6.39157935e-01
                6.41160200e-01
                6.43162466e-01
                6.45164731e-01
                6.47166997e-01
                6.49169262e-01
                6.51171528e-01
                6.53173793e-01
                6.55176059e-01
                6.57178324e-01
                6.59180590e-01
                6.61182855e-01
                6.63185121e-01
                6.65187386e-01
                6.67189652e-01
                6.69191917e-01
                6.71194183e-01
                6.73196449e-01
                6.75198714e-01
                6.77200980e-01
                6.79203245e-01
                6.81205511e-01
                6.83207776e-01
                6.85210042e-01
                6.87212307e-01
                6.89214573e-01
                6.91216838e-01
                6.93219104e-01
                6.95221369e-01
                6.97223635e-01
                6.99225900e-01
                7.01228166e-01
                7.03230431e-01
                7.05232697e-01
                7.07234963e-01
                7.09237228e-01
                7.11239494e-01
                7.13241759e-01
                7.15244025e-01
                7.17246290e-01
                7.19248556e-01
                7.21250821e-01
                7.23253087e-01
                7.25255352e-01
                7.27257618e-01
                7.29259883e-01
                7.31262149e-01
                7.33264414e-01
                7.35266680e-01
                7.37268945e-01
                7.39271211e-01
                7.41273476e-01
                7.43275742e-01
                7.45278008e-01
                7.47280273e-01
                7.49282539e-01
                7.51284804e-01
                7.53287070e-01
                7.55289335e-01
                7.57291601e-01
                7.59293866e-01
                7.61296132e-01
                7.63298397e-01
                7.65300663e-01
                7.67302928e-01
                7.69305194e-01
                7.71307459e-01
                7.73309725e-01
                7.75311990e-01
                7.77314256e-01
                7.79316522e-01
                7.81318787e-01
                7.83321053e-01
                7.85323318e-01
                7.87325584e-01
                7.89327849e-01
                7.91330115e-01
                7.93332380e-01
                7.95334646e-01
                7.97336911e-01
                7.99339177e-01
                8.01341442e-01
                8.03343708e-01
                8.05345973e-01
                8.07348239e-01
                8.09350504e-01
                8.11352770e-01
                8.13355035e-01
                8.15357301e-01
                8.17359567e-01
                8.19361832e-01
                8.21364098e-01
                8.23366363e-01
                8.25368629e-01
                8.27370894e-01
                8.29373160e-01
                8.31375425e-01
                8.33377691e-01
                8.35379956e-01
                8.37382222e-01
                8.39384487e-01
                8.41386753e-01
                8.43389018e-01
                8.45391284e-01
                8.47393549e-01
                8.49395815e-01
                8.51398080e-01
                8.53400346e-01
                8.55402612e-01
                8.57404877e-01
                8.59407143e-01
                8.61409408e-01
                8.63411674e-01
                8.65413939e-01
                8.67416205e-01
                8.69418470e-01
                8.71420736e-01
                8.73423001e-01
                8.75425267e-01
                8.77427532e-01
                8.79429798e-01
                8.81432063e-01
                8.83434329e-01
                8.85436594e-01
                8.87438860e-01
                8.89441126e-01
                8.91443391e-01
                8.93445657e-01
                8.95447922e-01
                8.97450188e-01
                8.99452453e-01
                9.01454719e-01
                9.03456984e-01
                9.05459250e-01
                9.07461515e-01
                9.09463781e-01
                9.11466046e-01
                9.13468312e-01
                9.15470577e-01
                9.17472843e-01
                9.19475108e-01
                9.21477374e-01
                9.23479639e-01
                9.25481905e-01
                9.27484171e-01
                9.29486436e-01
                9.31488702e-01
                9.33490967e-01
                9.35493233e-01
                9.37495498e-01
                9.39497764e-01
                9.41500029e-01
                9.43502295e-01
                9.45504560e-01
                9.47506826e-01
                9.49509091e-01
                9.51511357e-01
                9.53513622e-01
                9.55515888e-01
                9.57518153e-01
                9.59520419e-01
                9.61522685e-01
                9.63524950e-01
                9.65527216e-01
                9.67529481e-01
                9.69531747e-01
                9.71534012e-01
                9.73536278e-01
                9.75538543e-01
                9.77540809e-01
                9.79543074e-01
                9.81545340e-01
                9.83547605e-01
                9.85549871e-01
                9.87552136e-01
                9.89554402e-01
                9.91556667e-01
                9.93558933e-01
                9.95561198e-01
                9.97563464e-01
                9.99565730e-01
               ]
    OCP_vals  = [1.47850571e+00
               1.37712415e+00
               1.27921664e+00
               1.18777708e+00
               1.10500838e+00
               1.03052195e+00
               9.62859024e-01
               9.01931719e-01
               8.48415351e-01
               8.02819660e-01
               7.64090970e-01
               7.31067236e-01
               7.03352954e-01
               6.79786047e-01
               6.59164820e-01
               6.40682909e-01
               6.23966469e-01
               6.08611937e-01
               5.94459563e-01
               5.81345304e-01
               5.69175955e-01
               5.57888469e-01
               5.47322511e-01
               5.37527793e-01
               5.28346937e-01
               5.19677403e-01
               5.11482448e-01
               5.03693561e-01
               4.96174998e-01
               4.88917360e-01
               4.81819133e-01
               4.74891748e-01
               4.68305274e-01
               4.61941745e-01
               4.55698420e-01
               4.49466509e-01
               4.43422503e-01
               4.37534218e-01
               4.31614323e-01
               4.25527069e-01
               4.19385357e-01
               4.13177972e-01
               4.06955289e-01
               4.00713091e-01
               3.94563633e-01
               3.88401580e-01
               3.82396279e-01
               3.76458346e-01
               3.70672472e-01
               3.64990570e-01
               3.59448101e-01
               3.54019006e-01
               3.48732254e-01
               3.43574928e-01
               3.38517880e-01
               3.33593013e-01
               3.28701823e-01
               3.23980704e-01
               3.19339475e-01
               3.14794926e-01
               3.10324783e-01
               3.05971051e-01
               3.01623051e-01
               2.97416915e-01
               2.93254983e-01
               2.89148155e-01
               2.85135970e-01
               2.81128382e-01
               2.77215179e-01
               2.73464057e-01
               2.69899559e-01
               2.66559724e-01
               2.63491702e-01
               2.60547952e-01
               2.57240473e-01
               2.52967551e-01
               2.47883949e-01
               2.42721420e-01
               2.38367894e-01
               2.35102327e-01
               2.32743471e-01
               2.30891681e-01
               2.29555835e-01
               2.28426068e-01
               2.27551507e-01
               2.26795795e-01
               2.26128609e-01
               2.25532341e-01
               2.24988440e-01
               2.24548782e-01
               2.24167224e-01
               2.23784712e-01
               2.23406016e-01
               2.23083716e-01
               2.22736350e-01
               2.22490277e-01
               2.22243218e-01
               2.21891677e-01
               2.21681374e-01
               2.21493610e-01
               2.21193976e-01
               2.21003060e-01
               2.20731294e-01
               2.20453360e-01
               2.20153218e-01
               2.19885556e-01
               2.19566851e-01
               2.19148944e-01
               2.18627129e-01
               2.17988812e-01
               2.16979234e-01
               2.15547114e-01
               2.13757550e-01
               2.11764318e-01
               2.09659126e-01
               2.07620569e-01
               2.05687488e-01
               2.03818213e-01
               2.02134179e-01
               2.00469236e-01
               1.99010351e-01
               1.97555564e-01
               1.96221736e-01
               1.94836381e-01
               1.93552138e-01
               1.92184228e-01
               1.90795570e-01
               1.89274097e-01
               1.87690251e-01
               1.85996518e-01
               1.84369536e-01
               1.82667650e-01
               1.81149574e-01
               1.79622904e-01
               1.78262265e-01
               1.76936988e-01
               1.75719631e-01
               1.74611765e-01
               1.73528807e-01
               1.72561665e-01
               1.71643824e-01
               1.70729760e-01
               1.69896545e-01
               1.69144750e-01
               1.68358539e-01
               1.67578915e-01
               1.66835572e-01
               1.66153240e-01
               1.65432914e-01
               1.64559584e-01
               1.63712593e-01
               1.62918702e-01
               1.61998849e-01
               1.61048493e-01
               1.60153153e-01
               1.59155498e-01
               1.58131717e-01
               1.57214815e-01
               1.56279919e-01
               1.55349520e-01
               1.54472619e-01
               1.53670818e-01
               1.52816077e-01
               1.52000300e-01
               1.51261777e-01
               1.50550613e-01
               1.49828362e-01
               1.49106070e-01
               1.48468588e-01
               1.47863887e-01
               1.47328196e-01
               1.46707137e-01
               1.46050214e-01
               1.45525477e-01
               1.45059883e-01
               1.44504619e-01
               1.44030439e-01
               1.43533366e-01
               1.43014352e-01
               1.42564018e-01
               1.42132761e-01
               1.41748791e-01
               1.41366280e-01
               1.40986629e-01
               1.40609004e-01
               1.40267396e-01
               1.40022126e-01
               1.39778759e-01
               1.39460397e-01
               1.39259126e-01
               1.39077886e-01
               1.38883291e-01
               1.38696328e-01
               1.38634344e-01
               1.38367149e-01
               1.38163859e-01
               1.37971367e-01
               1.37933212e-01
               1.37745294e-01
               1.37565368e-01
               1.37539505e-01
               1.37360875e-01
               1.37175875e-01
               1.37170096e-01
               1.37041177e-01
               1.36958331e-01
               1.36788538e-01
               1.36788538e-01
               1.36670662e-01
               1.36597759e-01
               1.36435596e-01
               1.36406980e-01
               1.36406026e-01
               1.36267626e-01
               1.36215247e-01
               1.36216201e-01
               1.36154197e-01
               1.36025422e-01
               1.36025422e-01
               1.35955787e-01
               1.35835597e-01
               1.35812703e-01
               1.35654356e-01
               1.35643864e-01
               1.35643864e-01
               1.35639094e-01
               1.35505026e-01
               1.35453085e-01
               1.35434007e-01
               1.35287107e-01
               1.35262306e-01
               1.35262306e-01
               1.35254675e-01
               1.35128760e-01
               1.35072481e-01
               1.35067328e-01
               1.34928442e-01
               1.34943338e-01
               1.34889333e-01
               1.34880748e-01
               1.34808252e-01
               1.34695692e-01
               1.34677568e-01
               1.34535195e-01
               1.34499190e-01
               1.34499190e-01
               1.34486789e-01
               1.34345811e-01
               1.34308411e-01
               1.34268347e-01
               1.34124145e-01
               1.34117632e-01
               1.34117632e-01
               1.34109047e-01
               1.33952608e-01
               1.33926853e-01
               1.33814293e-01
               1.33736074e-01
               1.33735120e-01
               1.33729396e-01
               1.33730350e-01
               1.33560149e-01
               1.33361193e-01
               1.33354516e-01
               1.33342115e-01
               1.33164691e-01
               1.33068384e-01
               1.32972958e-01
               1.32972958e-01
               1.32793626e-01
               1.32635891e-01
               1.32591400e-01
               1.32404436e-01
               1.32215565e-01
               1.32097455e-01
               1.31844500e-01
               1.31694722e-01
               1.31446726e-01
               1.31159391e-01
               1.30907160e-01
               1.30596401e-01
               1.30258615e-01
               1.29920494e-01
               1.29532462e-01
               1.28966743e-01
               1.28341750e-01
               1.27697773e-01
               1.26981054e-01
               1.26250170e-01
               1.25330912e-01
               1.24313326e-01
               1.23225004e-01
               1.21921843e-01
               1.20597326e-01
               1.19133701e-01
               1.17638659e-01
               1.16106145e-01
               1.14604634e-01
               1.13159691e-01
               1.11775763e-01
               1.10496304e-01
               1.09225429e-01
               1.08182528e-01
               1.07186341e-01
               1.06267544e-01
               1.05488976e-01
               1.04786024e-01
               1.04118755e-01
               1.03535267e-01
               1.03102100e-01
               1.02597353e-01
               1.02105986e-01
               1.01721467e-01
               1.01360797e-01
               1.01104863e-01
               1.00786332e-01
               1.00538217e-01
               1.00226198e-01
               1.00032427e-01
               9.97783670e-02
               9.96096032e-02
               9.93987168e-02
               9.93585128e-02
               9.91151587e-02
               9.90142971e-02
               9.88330571e-02
               9.86531045e-02
               9.86289235e-02
               9.84419601e-02
               9.82712192e-02
               9.82511811e-02
               9.81033274e-02
               9.79999093e-02
               9.78696231e-02
               9.78648537e-02
               9.77284467e-02
               9.76883831e-02
               9.75842967e-02
               9.74880652e-02
               9.74518171e-02
               9.72991940e-02
               9.72410064e-02
               9.71065072e-02
               9.71065072e-02
               9.70960143e-02
               9.69433911e-02
               9.69157282e-02
               9.68084663e-02
               9.67249492e-02
               9.67249492e-02
               9.67230414e-02
               9.66342222e-02
               9.65351241e-02
               9.65227235e-02
               9.63996710e-02
               9.63443451e-02
               9.63433912e-02
               9.63433912e-02
               9.63433912e-02
               9.63088916e-02
               9.61840907e-02
               9.61526122e-02
               9.61344882e-02
               9.60181130e-02
               9.59627871e-02
               9.59618332e-02
               9.61373499e-02
               9.60172567e-02
               9.59656488e-02
               9.59618332e-02
               9.59618332e-02
               9.57701003e-02
               9.57262212e-02
               9.56003070e-02
               9.55812291e-02
               9.55802752e-02
               9.55802752e-02
               9.55771297e-02
               9.55201798e-02
               9.54266981e-02
               9.53894962e-02
               9.53894962e-02
               9.53628022e-02
               9.52465639e-02
               9.51996711e-02
               9.51987172e-02
               9.51987172e-02
               9.51987172e-02
               9.51941868e-02
               9.51500686e-02
               9.50432324e-02
               9.50088921e-02
               9.50060305e-02
               9.49760844e-02
               9.48734391e-02
               9.48171593e-02
               9.48171593e-02
               9.48171593e-02
               9.48171593e-02
               9.48026916e-02
               9.46962701e-02
               9.48171593e-02
               9.48171593e-02
               9.48171593e-02
               9.48018969e-02
               9.47286419e-02
               9.44375091e-02
               9.44356013e-02
               9.44356013e-02
               9.44356013e-02
               9.44336935e-02
               9.43812293e-02
               9.42727903e-02
               9.42457762e-02
               9.42028509e-02
               9.41522945e-02
               9.40769368e-02
               9.40540433e-02
               9.40540433e-02
               9.40540433e-02
               9.40530894e-02
               9.40332085e-02
               9.39452993e-02
               9.38737571e-02
               9.38632643e-02
               9.38575409e-02
               9.37755060e-02
               9.38918811e-02
               9.38642182e-02
               9.38623104e-02
               9.38050767e-02
               9.36877476e-02
               9.35470513e-02
               9.34836141e-02
               9.34788446e-02
               9.34243990e-02
               9.32995124e-02
               9.32909273e-02
               9.32909273e-02
               9.32909273e-02
               9.32852040e-02
               9.31690748e-02
               9.31001483e-02
               9.30763010e-02
               9.29284472e-02
               9.29093693e-02
               9.29074615e-02
               9.28912453e-02
               9.27350161e-02
               9.27157287e-02
               9.25544726e-02
               9.25278114e-02
               9.25239958e-02
               9.23594668e-02
               9.23227239e-02
               9.21481612e-02
               9.21462534e-02
               9.20308233e-02
               9.19402121e-02
               9.17646954e-02
               9.17138058e-02
               9.15586541e-02
               9.13831374e-02
               9.13211342e-02
               9.13421199e-02
               9.10969689e-02
               9.09891788e-02
               9.07390496e-02
               9.04906125e-02
               9.02356018e-02
               8.98974102e-02
               8.96842505e-02
               8.94011550e-02
               8.90832966e-02
               8.87017387e-02
               8.83058722e-02
               8.78505721e-02
               8.73248420e-02
               8.68296377e-02
               8.61954131e-02
               8.54434806e-02
               8.46572037e-02
               8.38259364e-02
               8.28290006e-02
               8.16884564e-02
               8.04928821e-02
               7.90378698e-02
               7.74924851e-02
               7.56797034e-02
               7.36694915e-02
               7.15847501e-02
               6.90152673e-02
               6.61155443e-02
               6.28773058e-02
               5.91120749e-02
               5.48190008e-02
               5.01190627e-02
               4.48500459e-02
               3.89137131e-02
               3.18600917e-02
              ]

    # Création de l'interpolateur local (interpolation linéaire + extrapolation)
    itp = get_1d_interpolator(stoc_vals, OCP_vals, cap_endpoints = false)

    # Évaluation du potentiel
    OCP = itp(stoc)

    # Dérivée par rapport à T (fixée à 0 ici)
    dUdT = 0.0

    return OCP
end

function computeOCPcathodeDLR2(c,T,cmax)
    # Concentration normalisée
    stoc = c / cmax

    # Table de données (exemple : à remplacer par vos vraies valeurs)
    stoc_vals = [2.10304792e-01
            2.11886737e-01
            2.13468682e-01
            2.15050626e-01
            2.16632571e-01
            2.18214516e-01
            2.19796461e-01
            2.21378405e-01
            2.22960350e-01
            2.24542295e-01
            2.26124239e-01
        2.27706184e-01
        2.29288129e-01
        2.30870074e-01
        2.32452018e-01
        2.34033963e-01
        2.35615908e-01
        2.37197852e-01
        2.38779797e-01
        2.40361742e-01
        2.41943687e-01
        2.43525631e-01
        2.45107576e-01
        2.46689521e-01
        2.48271466e-01
        2.49853410e-01
        2.51435355e-01
        2.53017300e-01
        2.54599244e-01
        2.56181189e-01
        2.57763134e-01
        2.59345079e-01
        2.60927023e-01
        2.62508968e-01
        2.64090913e-01
        2.65672857e-01
        2.67254802e-01
        2.68836747e-01
        2.70418692e-01
        2.72000636e-01
        2.73582581e-01
        2.75164526e-01
        2.76746470e-01
        2.78328415e-01
        2.79910360e-01
        2.81492305e-01
        2.83074249e-01
        2.84656194e-01
        2.86238139e-01
        2.87820084e-01
        2.89402028e-01
        2.90983973e-01
        2.92565918e-01
        2.94147862e-01
        2.95729807e-01
        2.97311752e-01
        2.98893697e-01
        3.00475641e-01
        3.02057586e-01
        3.03639531e-01
        3.05221475e-01
        3.06803420e-01
        3.08385365e-01
        3.09967310e-01
        3.11549254e-01
        3.13131199e-01
        3.14713144e-01
        3.16295088e-01
        3.17877033e-01
        3.19458978e-01
        3.21040923e-01
        3.22622867e-01
        3.24204812e-01
        3.25786757e-01
        3.27368702e-01
        3.28950646e-01
        3.30532591e-01
        3.32114536e-01
        3.33696480e-01
        3.35278425e-01
        3.36860370e-01
        3.38442315e-01
        3.40024259e-01
        3.41606204e-01
        3.43188149e-01
        3.44770093e-01
        3.46352038e-01
        3.47933983e-01
        3.49515928e-01
        3.51097872e-01
        3.52679817e-01
        3.54261762e-01
        3.55843707e-01
        3.57425651e-01
        3.59007596e-01
        3.60589541e-01
        3.62171485e-01
        3.63753430e-01
        3.65335375e-01
        3.66917320e-01
        3.68499264e-01
        3.70081209e-01
        3.71663154e-01
        3.73245098e-01
        3.74827043e-01
        3.76408988e-01
        3.77990933e-01
        3.79572877e-01
        3.81154822e-01
        3.82736767e-01
        3.84318711e-01
        3.85900656e-01
        3.87482601e-01
        3.89064546e-01
        3.90646490e-01
        3.92228435e-01
        3.93810380e-01
        3.95392325e-01
        3.96974269e-01
        3.98556214e-01
        4.00138159e-01
        4.01720103e-01
        4.03302048e-01
        4.04883993e-01
        4.06465938e-01
        4.08047882e-01
        4.09629827e-01
        4.11211772e-01
        4.12793716e-01
        4.14375661e-01
        4.15957606e-01
        4.17539551e-01
        4.19121495e-01
        4.20703440e-01
        4.22285385e-01
        4.23867329e-01
        4.25449274e-01
        4.27031219e-01
        4.28613164e-01
        4.30195108e-01
        4.31777053e-01
        4.33358998e-01
        4.34940943e-01
        4.36522887e-01
        4.38104832e-01
        4.39686777e-01
        4.41268721e-01
        4.42850666e-01
        4.44432611e-01
        4.46014556e-01
        4.47596500e-01
        4.49178445e-01
        4.50760390e-01
        4.52342334e-01
        4.53924279e-01
        4.55506224e-01
        4.57088169e-01
        4.58670113e-01
        4.60252058e-01
        4.61834003e-01
        4.63415948e-01
        4.64997892e-01
        4.66579837e-01
        4.68161782e-01
        4.69743726e-01
        4.71325671e-01
        4.72907616e-01
        4.74489561e-01
        4.76071505e-01
        4.77653450e-01
        4.79235395e-01
        4.80817339e-01
        4.82399284e-01
        4.83981229e-01
        4.85563174e-01
        4.87145118e-01
        4.88727063e-01
        4.90309008e-01
        4.91890952e-01
        4.93472897e-01
        4.95054842e-01
        4.96636787e-01
        4.98218731e-01
        4.99800676e-01
        5.01382621e-01
        5.02964566e-01
        5.04546510e-01
        5.06128455e-01
        5.07710400e-01
        5.09292344e-01
        5.10874289e-01
        5.12456234e-01
        5.14038179e-01
        5.15620123e-01
        5.17202068e-01
        5.18784013e-01
        5.20365957e-01
        5.21947902e-01
        5.23529847e-01
        5.25111792e-01
        5.26693736e-01
        5.28275681e-01
        5.29857626e-01
        5.31439570e-01
        5.33021515e-01
        5.34603460e-01
        5.36185405e-01
        5.37767349e-01
        5.39349294e-01
        5.40931239e-01
        5.42513184e-01
        5.44095128e-01
        5.45677073e-01
        5.47259018e-01
        5.48840962e-01
        5.50422907e-01
        5.52004852e-01
        5.53586797e-01
        5.55168741e-01
        5.56750686e-01
        5.58332631e-01
        5.59914575e-01
        5.61496520e-01
        5.63078465e-01
        5.64660410e-01
        5.66242354e-01
        5.67824299e-01
        5.69406244e-01
        5.70988189e-01
        5.72570133e-01
        5.74152078e-01
        5.75734023e-01
        5.77315967e-01
        5.78897912e-01
        5.80479857e-01
        5.82061802e-01
        5.83643746e-01
        5.85225691e-01
        5.86807636e-01
        5.88389580e-01
        5.89971525e-01
        5.91553470e-01
        5.93135415e-01
        5.94717359e-01
        5.96299304e-01
        5.97881249e-01
        5.99463193e-01
        6.01045138e-01
        6.02627083e-01
        6.04209028e-01
        6.05790972e-01
        6.07372917e-01
        6.08954862e-01
        6.10536807e-01
        6.12118751e-01
        6.13700696e-01
        6.15282641e-01
        6.16864585e-01
        6.18446530e-01
        6.20028475e-01
        6.21610420e-01
        6.23192364e-01
        6.24774309e-01
        6.26356254e-01
        6.27938198e-01
        6.29520143e-01
        6.31102088e-01
        6.32684033e-01
        6.34265977e-01
        6.35847922e-01
        6.37429867e-01
        6.39011811e-01
        6.40593756e-01
        6.42175701e-01
        6.43757646e-01
        6.45339590e-01
        6.46921535e-01
        6.48503480e-01
        6.50085425e-01
        6.51667369e-01
        6.53249314e-01
        6.54831259e-01
        6.56413203e-01
        6.57995148e-01
        6.59577093e-01
        6.61159038e-01
        6.62740982e-01
        6.64322927e-01
        6.65904872e-01
        6.67486816e-01
        6.69068761e-01
        6.70650706e-01
        6.72232651e-01
        6.73814595e-01
        6.75396540e-01
        6.76978485e-01
        6.78560430e-01
        6.80142374e-01
        6.81724319e-01
        6.83306264e-01
        6.84888208e-01
        6.86470153e-01
        6.88052098e-01
        6.89634043e-01
        6.91215987e-01
        6.92797932e-01
        6.94379877e-01
        6.95961821e-01
        6.97543766e-01
        6.99125711e-01
        7.00707656e-01
        7.02289600e-01
        7.03871545e-01
        7.05453490e-01
        7.07035434e-01
        7.08617379e-01
        7.10199324e-01
        7.11781269e-01
        7.13363213e-01
        7.14945158e-01
        7.16527103e-01
        7.18109048e-01
        7.19690992e-01
        7.21272937e-01
        7.22854882e-01
        7.24436826e-01
        7.26018771e-01
        7.27600716e-01
        7.29182661e-01
        7.30764605e-01
        7.32346550e-01
        7.33928495e-01
        7.35510439e-01
        7.37092384e-01
        7.38674329e-01
        7.40256274e-01
        7.41838218e-01
        7.43420163e-01
        7.45002108e-01
        7.46584052e-01
        7.48165997e-01
        7.49747942e-01
        7.51329887e-01
        7.52911831e-01
        7.54493776e-01
        7.56075721e-01
        7.57657666e-01
        7.59239610e-01
        7.60821555e-01
        7.62403500e-01
        7.63985444e-01
        7.65567389e-01
        7.67149334e-01
        7.68731279e-01
        7.70313223e-01
        7.71895168e-01
        7.73477113e-01
        7.75059057e-01
        7.76641002e-01
        7.78222947e-01
        7.79804892e-01
        7.81386836e-01
        7.82968781e-01
        7.84550726e-01
        7.86132671e-01
        7.87714615e-01
        7.89296560e-01
        7.90878505e-01
        7.92460449e-01
        7.94042394e-01
        7.95624339e-01
        7.97206284e-01
        7.98788228e-01
        8.00370173e-01
        8.01952118e-01
        8.03534062e-01
        8.05116007e-01
        8.06697952e-01
        8.08279897e-01
        8.09861841e-01
        8.11443786e-01
        8.13025731e-01
        8.14607675e-01
        8.16189620e-01
        8.17771565e-01
        8.19353510e-01
        8.20935454e-01
        8.22517399e-01
        8.24099344e-01
        8.25681289e-01
        8.27263233e-01
        8.28845178e-01
        8.30427123e-01
        8.32009067e-01
        8.33591012e-01
        8.35172957e-01
        8.36754902e-01
        8.38336846e-01
        8.39918791e-01
        8.41500736e-01
        8.43082680e-01
        8.44664625e-01
        8.46246570e-01
        8.47828515e-01
        8.49410459e-01
        8.50992404e-01
        8.52574349e-01
        8.54156293e-01
        8.55738238e-01
        8.57320183e-01
        8.58902128e-01
        8.60484072e-01
        8.62066017e-01
        8.63647962e-01
        8.65229907e-01
        8.66811851e-01
        8.68393796e-01
        8.69975741e-01
        8.71557685e-01
        8.73139630e-01
        8.74721575e-01
        8.76303520e-01
        8.77885464e-01
        8.79467409e-01
        8.81049354e-01
        8.82631298e-01
        8.84213243e-01
        8.85795188e-01
        8.87377133e-01
        8.88959077e-01
        8.90541022e-01
        8.92122967e-01
        8.93704912e-01
        8.95286856e-01
        8.96868801e-01
        8.98450746e-01
        9.00032690e-01
        9.01614635e-01
        9.03196580e-01
        9.04778525e-01
        9.06360469e-01
        9.07942414e-01
        9.09524359e-01
        9.11106303e-01
        9.12688248e-01
        9.14270193e-01
        9.15852138e-01
        9.17434082e-01
        9.19016027e-01
        9.20597972e-01
        9.22179916e-01
        9.23761861e-01
        9.25343806e-01
        9.26925751e-01
        9.28507695e-01
        9.30089640e-01
        9.31671585e-01
        9.33253530e-01
        9.34835474e-01
        9.36417419e-01
        9.37999364e-01
        9.39581308e-01
        9.41163253e-01
        9.42745198e-01
        9.44327143e-01
        9.45909087e-01
        9.47491032e-01
        9.49072977e-01
        9.50654921e-01
        9.52236866e-01
        9.53818811e-01
        9.55400756e-01
        9.56982700e-01
        9.58564645e-01
        9.60146590e-01
        9.61728534e-01
        9.63310479e-01
        9.64892424e-01
        9.66474369e-01
        9.68056313e-01
        9.69638258e-01
        9.71220203e-01
        9.72802148e-01
        9.74384092e-01
        9.75966037e-01
        9.77547982e-01
        9.79129926e-01
        9.80711871e-01
        9.82293816e-01
        9.83875761e-01
        9.85457705e-01
        9.87039650e-01
        9.88621595e-01
        9.90203539e-01
        9.91785484e-01
        9.93367429e-01
        9.94949374e-01
        9.96531318e-01
        9.98113263e-01
        9.99695208e-01
        ]
    OCP_vals  = [4.36191170e+00
        4.35029304e+00
        4.34007945e+00
        4.33021483e+00
        4.32075933e+00
        4.31168338e+00
        4.30295997e+00
        4.29463412e+00
        4.28680454e+00
        4.27925201e+00
        4.27212675e+00
        4.26535560e+00
        4.25895234e+00
        4.25289911e+00
        4.24724181e+00
        4.24188887e+00
        4.23683392e+00
        4.23208059e+00
        4.22760761e+00
        4.22349082e+00
        4.21956678e+00
        4.21590581e+00
        4.21249841e+00
        4.20928406e+00
        4.20633408e+00
        4.20357682e+00
        4.20102909e+00
        4.19866752e+00
        4.19640577e+00
        4.19428229e+00
        4.19238396e+00
        4.19050372e+00
        4.18880440e+00
        4.18719601e+00
        4.18558734e+00
        4.18418982e+00
        4.18283890e+00
        4.18151888e+00
        4.18037099e+00
        4.17916298e+00
        4.17810406e+00
        4.17708199e+00
        4.17603998e+00
        4.17511663e+00
        4.17423380e+00
        4.17326712e+00
        4.17241147e+00
        4.17166680e+00
        4.17085809e+00
        4.17004604e+00
        4.16928168e+00
        4.16862019e+00
        4.16788693e+00
        4.16710521e+00
        4.16638110e+00
        4.16572178e+00
        4.16502653e+00
        4.16429370e+00
        4.16355367e+00
        4.16287116e+00
        4.16217631e+00
        4.16130774e+00
        4.16051953e+00
        4.15975778e+00
        4.15894090e+00
        4.15798567e+00
        4.15705207e+00
        4.15613926e+00
        4.15501409e+00
        4.15389228e+00
        4.15275926e+00
        4.15143060e+00
        4.15014930e+00
        4.14865798e+00
        4.14722320e+00
        4.14556738e+00
        4.14395658e+00
        4.14214459e+00
        4.14039919e+00
        4.13851119e+00
        4.13647288e+00
        4.13451020e+00
        4.13241321e+00
        4.13028097e+00
        4.12817039e+00
        4.12595003e+00
        4.12360716e+00
        4.12133087e+00
        4.11902293e+00
        4.11668030e+00
        4.11423873e+00
        4.11176088e+00
        4.10934022e+00
        4.10690611e+00
        4.10444637e+00
        4.10191303e+00
        4.09952219e+00
        4.09701203e+00
        4.09452147e+00
        4.09202871e+00
        4.08949309e+00
        4.08688831e+00
        4.08434167e+00
        4.08184332e+00
        4.07936657e+00
        4.07689081e+00
        4.07434705e+00
        4.07185289e+00
        4.06940093e+00
        4.06700496e+00
        4.06461317e+00
        4.06214311e+00
        4.05973950e+00
        4.05741350e+00
        4.05513772e+00
        4.05283999e+00
        4.05052230e+00
        4.04830356e+00
        4.04614529e+00
        4.04391652e+00
        4.04173889e+00
        4.03962987e+00
        4.03752647e+00
        4.03540125e+00
        4.03339557e+00
        4.03141424e+00
        4.02937046e+00
        4.02742419e+00
        4.02548401e+00
        4.02354867e+00
        4.02171209e+00
        4.01980403e+00
        4.01800998e+00
        4.01621524e+00
        4.01434145e+00
        4.01263755e+00
        4.01082122e+00
        4.00913209e+00
        4.00738878e+00
        4.00568500e+00
        4.00402189e+00
        4.00227899e+00
        4.00067019e+00
        3.99891921e+00
        3.99729973e+00
        3.99556117e+00
        3.99394249e+00
        3.99221708e+00
        3.99048306e+00
        3.98883214e+00
        3.98708685e+00
        3.98543790e+00
        3.98366119e+00
        3.98199782e+00
        3.98018522e+00
        3.97843080e+00
        3.97668878e+00
        3.97487734e+00
        3.97314124e+00
        3.97126263e+00
        3.96949920e+00
        3.96762972e+00
        3.96570020e+00
        3.96389782e+00
        3.96195502e+00
        3.96008456e+00
        3.95820731e+00
        3.95622927e+00
        3.95433877e+00
        3.95237679e+00
        3.95038857e+00
        3.94848436e+00
        3.94644860e+00
        3.94446503e+00
        3.94251564e+00
        3.94041116e+00
        3.93838363e+00
        3.93641430e+00
        3.93432559e+00
        3.93227516e+00
        3.93027400e+00
        3.92814058e+00
        3.92606935e+00
        3.92405657e+00
        3.92195180e+00
        3.91985014e+00
        3.91778990e+00
        3.91566333e+00
        3.91352992e+00
        3.91146814e+00
        3.90937796e+00
        3.90721294e+00
        3.90513341e+00
        3.90307474e+00
        3.90088740e+00
        3.89878519e+00
        3.89671314e+00
        3.89453315e+00
        3.89232748e+00
        3.89023698e+00
        3.88809885e+00
        3.88588724e+00
        3.88375996e+00
        3.88164843e+00
        3.87940569e+00
        3.87725132e+00
        3.87513260e+00
        3.87296662e+00
        3.87075503e+00
        3.86859200e+00
        3.86645702e+00
        3.86425030e+00
        3.86208689e+00
        3.85998295e+00
        3.85779496e+00
        3.85563542e+00
        3.85354624e+00
        3.85142051e+00
        3.84923861e+00
        3.84717310e+00
        3.84509997e+00
        3.84291000e+00
        3.84085586e+00
        3.83887729e+00
        3.83676236e+00
        3.83475365e+00
        3.83282940e+00
        3.83073347e+00
        3.82878479e+00
        3.82690501e+00
        3.82489078e+00
        3.82303520e+00
        3.82114687e+00
        3.81920104e+00
        3.81742374e+00
        3.81555973e+00
        3.81378205e+00
        3.81200710e+00
        3.81024341e+00
        3.80856683e+00
        3.80680906e+00
        3.80517049e+00
        3.80344083e+00
        3.80185584e+00
        3.80017757e+00
        3.79863620e+00
        3.79700998e+00
        3.79545747e+00
        3.79388472e+00
        3.79239831e+00
        3.79087394e+00
        3.78941841e+00
        3.78789634e+00
        3.78649720e+00
        3.78501870e+00
        3.78366692e+00
        3.78218286e+00
        3.78088013e+00
        3.77944581e+00
        3.77816684e+00
        3.77676244e+00
        3.77545918e+00
        3.77417270e+00
        3.77281340e+00
        3.77159102e+00
        3.77020936e+00
        3.76901216e+00
        3.76770316e+00
        3.76646023e+00
        3.76526157e+00
        3.76397974e+00
        3.76282356e+00
        3.76155397e+00
        3.76035805e+00
        3.75921246e+00
        3.75796192e+00
        3.75684691e+00
        3.75563629e+00
        3.75445700e+00
        3.75334921e+00
        3.75211997e+00
        3.75099963e+00
        3.74988358e+00
        3.74869634e+00
        3.74761469e+00
        3.74637771e+00
        3.74522554e+00
        3.74417654e+00
        3.74299702e+00
        3.74190391e+00
        3.74078875e+00
        3.73961893e+00
        3.73858642e+00
        3.73746080e+00
        3.73629574e+00
        3.73526133e+00
        3.73405971e+00
        3.73294025e+00
        3.73190792e+00
        3.73073697e+00
        3.72967500e+00
        3.72857599e+00
        3.72740522e+00
        3.72638511e+00
        3.72525382e+00
        3.72410768e+00
        3.72306186e+00
        3.72185690e+00
        3.72073223e+00
        3.71968685e+00
        3.71852135e+00
        3.71744704e+00
        3.71634562e+00
        3.71517368e+00
        3.71412132e+00
        3.71297389e+00
        3.71181416e+00
        3.71075830e+00
        3.70970683e+00
        3.70857457e+00
        3.70751210e+00
        3.70633044e+00
        3.70522082e+00
        3.70407681e+00
        3.70287904e+00
        3.70181938e+00
        3.70061605e+00
        3.69941859e+00
        3.69833120e+00
        3.69706752e+00
        3.69595661e+00
        3.69475789e+00
        3.69354391e+00
        3.69243884e+00
        3.69118955e+00
        3.69001688e+00
        3.68885033e+00
        3.68757040e+00
        3.68644194e+00
        3.68513020e+00
        3.68393846e+00
        3.68271666e+00
        3.68143688e+00
        3.68027326e+00
        3.67894905e+00
        3.67775363e+00
        3.67656630e+00
        3.67527408e+00
        3.67406921e+00
        3.67263077e+00
        3.67139211e+00
        3.67003749e+00
        3.66876232e+00
        3.66746468e+00
        3.66610603e+00
        3.66486502e+00
        3.66348488e+00
        3.66221931e+00
        3.66081149e+00
        3.65949828e+00
        3.65815044e+00
        3.65675082e+00
        3.65544285e+00
        3.65402677e+00
        3.65272565e+00
        3.65127198e+00
        3.64994026e+00
        3.64844907e+00
        3.64711296e+00
        3.64573519e+00
        3.64434139e+00
        3.64294495e+00
        3.64148410e+00
        3.64013665e+00
        3.63864761e+00
        3.63727153e+00
        3.63575612e+00
        3.63439846e+00
        3.63289599e+00
        3.63152038e+00
        3.63002145e+00
        3.62865362e+00
        3.62714181e+00
        3.62576767e+00
        3.62421982e+00
        3.62281009e+00
        3.62134589e+00
        3.61990479e+00
        3.61845825e+00
        3.61698250e+00
        3.61556941e+00
        3.61407160e+00
        3.61266677e+00
        3.61116261e+00
        3.60975912e+00
        3.60824791e+00
        3.60684340e+00
        3.60532277e+00
        3.60392671e+00
        3.60240712e+00
        3.60101183e+00
        3.59944303e+00
        3.59804291e+00
        3.59653499e+00
        3.59515196e+00
        3.59362884e+00
        3.59222123e+00
        3.59071415e+00
        3.58928552e+00
        3.58777475e+00
        3.58633283e+00
        3.58490186e+00
        3.58342829e+00
        3.58202231e+00
        3.58051769e+00
        3.57915132e+00
        3.57765715e+00
        3.57628602e+00
        3.57475005e+00
        3.57340743e+00
        3.57192371e+00
        3.57058964e+00
        3.56911446e+00
        3.56777089e+00
        3.56632588e+00
        3.56495335e+00
        3.56356969e+00
        3.56216665e+00
        3.56085755e+00
        3.55943149e+00
        3.55814611e+00
        3.55672756e+00
        3.55544024e+00
        3.55405432e+00
        3.55272785e+00
        3.55135432e+00
        3.54997465e+00
        3.54869993e+00
        3.54731361e+00
        3.54606073e+00
        3.54467061e+00
        3.54341055e+00
        3.54205327e+00
        3.54072363e+00
        3.53942223e+00
        3.53804166e+00
        3.53676944e+00
        3.53538476e+00
        3.53409768e+00
        3.53269574e+00
        3.53136634e+00
        3.53002657e+00
        3.52858560e+00
        3.52726197e+00
        3.52576590e+00
        3.52437103e+00
        3.52284456e+00
        3.52144780e+00
        3.51987951e+00
        3.51850854e+00
        3.51685462e+00
        3.51518752e+00
        3.51363022e+00
        3.51200344e+00
        3.51021678e+00
        3.50839206e+00
        3.50655567e+00
        3.50450140e+00
        3.50240927e+00
        3.50025196e+00
        3.49788293e+00
        3.49534680e+00
        3.49270000e+00
        3.48979210e+00
        3.48664018e+00
        3.48318009e+00
        3.47939861e+00
        3.47506549e+00
        3.47021861e+00
        3.46464706e+00
        3.45816253e+00
        3.45043990e+00
        3.44111958e+00
        3.42966467e+00
        3.41546060e+00
        3.39766705e+00
        3.37549651e+00
        3.34834861e+00
        3.31586737e+00
        3.27781350e+00
        3.23451466e+00
        3.18641780e+00
        3.13339817e+00
        3.07399347e+00
        3.00579885e+00
        2.92695772e+00
        2.83701380e+00
        2.73701283e+00
        2.62973270e+00
        2.51992790e+00
        ]

    # Création de l'interpolateur local (interpolation linéaire + extrapolation)
    itp = get_1d_interpolator(stoc_vals, OCP_vals, cap_endpoints = false)

    # Évaluation du potentiel
    OCP = itp(stoc)

    # Dérivée par rapport à T (fixée à 0 ici)
    dUdT = 0.0

    return OCP
end


function computeDanodeDLR(soc)
    

    # Table of SoC values and corresponding D values [m²/s]
    soc_vals = [0.00000000e+00
                2.45245245e-02
                3.41300897e-02
                4.37356548e-02
                5.33412200e-02
                6.29467852e-02
                7.25523503e-02
                8.21579155e-02
                9.17634807e-02
                1.01369046e-01
                1.10974611e-01
                1.20580176e-01
                1.30185741e-01
                1.39791306e-01
                1.49396872e-01
                1.59002437e-01
                1.68608002e-01
                1.78213567e-01
                1.87819132e-01
                1.97424697e-01
                2.07030263e-01
                2.16635828e-01
                2.26241393e-01
                2.35846958e-01
                2.45452523e-01
                2.55058088e-01
                2.64663654e-01
                2.74269219e-01
                2.83874784e-01
                2.93480349e-01
                3.03085914e-01
                3.12691479e-01
                3.22297045e-01
                3.31902610e-01
                3.41508175e-01
                3.51113740e-01
                3.60719305e-01
                3.70324870e-01
                3.79930435e-01
                3.89536001e-01
                3.99141566e-01
                4.08747131e-01
                4.18352696e-01
                4.27958261e-01
                4.37563826e-01
                4.47169392e-01
                4.56774957e-01
                4.66380522e-01
                4.75986087e-01
                4.85591652e-01
                4.95197217e-01
                5.04802783e-01
                5.14408348e-01
                5.24013913e-01
                5.33619478e-01
                5.43225043e-01
                5.52830608e-01
                5.62436174e-01
                5.72041739e-01
                5.81647304e-01
                5.91252869e-01
                6.00858434e-01
                6.10463999e-01
                6.20069565e-01
                6.29675130e-01
                6.39280695e-01
                6.48886260e-01
                6.58491825e-01
                6.68097390e-01
                6.77702955e-01
                6.87308521e-01
                6.96914086e-01
                7.06519651e-01
                7.16125216e-01
                7.25730781e-01
                7.35336346e-01
                7.44941912e-01
                7.54547477e-01
                7.64153042e-01
                7.73758607e-01
                7.83364172e-01
                7.92969737e-01
                8.02575303e-01
                8.12180868e-01
                8.21786433e-01
                8.31391998e-01
                8.40997563e-01
                8.50603128e-01
                8.60208694e-01
                8.69814259e-01
                8.79419824e-01
                8.89025389e-01
                8.98630954e-01
                9.08236519e-01
                9.17842085e-01
                9.27447650e-01
                9.37053215e-01
                9.46658780e-01
                9.56264345e-01
                9.65869910e-01
                9.75475475e-01
                1.00000000e+00
               ]
    D_vals   = [1.25338000e-11
              1.11749820e-11
              1.12805028e-11
              1.18104235e-11
              1.25730093e-11
              1.35707878e-11
              1.45257368e-11
              1.42390510e-11
              1.34173889e-11
              1.22021355e-11
              1.06299363e-11
              8.48506938e-12
              7.23075502e-12
              6.68049120e-12
              6.78163175e-12
              7.53346280e-12
              8.93534188e-12
              1.09276961e-11
              1.27239673e-11
              1.40817343e-11
              1.50016696e-11
              1.54840135e-11
              1.55304794e-11
              1.53443294e-11
              1.50524280e-11
              1.46549838e-11
              1.41520084e-11
              1.35432701e-11
              1.27815317e-11
              1.18046445e-11
              1.06127358e-11
              9.20573479e-12
              7.58326389e-12
              5.87023220e-12
              4.40342860e-12
              3.20165603e-12
              2.26511818e-12
              1.59416430e-12
              1.16505951e-12
              8.45295061e-13
              6.12856635e-13
              4.67849739e-13
              4.10351100e-13
              4.38311567e-13
              5.23245323e-13
              6.54969683e-13
              8.33561749e-13
              1.05904208e-12
              1.33354499e-12
              1.89387775e-12
              2.89745377e-12
              4.34519840e-12
              6.23711165e-12
              8.57226815e-12
              1.07810304e-11
              1.20310452e-11
              1.23126092e-11
              1.16261472e-11
              9.97325156e-12
              7.66917183e-12
              5.66184066e-12
              4.01590151e-12
              2.73103750e-12
              1.80681294e-12
              1.21461681e-12
              7.63660275e-13
              4.20132951e-13
              1.83893574e-13
              5.48597405e-14
              2.90871047e-14
              3.21821660e-14
              3.65370558e-14
              4.21495657e-14
              4.90192818e-14
              5.71704312e-14
              6.94910518e-14
              8.81470382e-14
              1.13124512e-13
              1.44424168e-13
              1.82058495e-13
              2.22051739e-13
              2.58014775e-13
              2.89860425e-13
              3.17586429e-13
              3.41186458e-13
              3.63672691e-13
              3.94820123e-13
              4.35362274e-13
              4.85308429e-13
              5.44668906e-13
              6.11024841e-13
              6.81487100e-13
              8.40903195e-13
              8.40753478e-13
              8.86641353e-13
              1.13995461e-12
              1.78472598e-12
              3.01069130e-12
              4.96449911e-12
              7.97787984e-12
              1.21603310e-11
              2.67593000e-11]

    # Interpolation with extrapolation beyond known range (linear)
    itp = LinearInterpolation(soc_vals, D_vals, extrapolation_bc=Line())

    D = itp(soc)  # D in [m²/s]

    return D
end

function computeDcathodeDLR(soc)
    

    # Table of SoC values and corresponding D values [m²/s]
    soc_vals = [0.00000000e+00
                 1.00000000e-02
                 2.00000000e-02
                 3.00000000e-02
                 4.00000000e-02
                 5.00000000e-02
                 6.00000000e-02
                 7.00000000e-02
                 8.00000000e-02
                 9.00000000e-02
                 1.00000000e-01
                 1.50000000e-01
                 2.00000000e-01
                 2.50000000e-01
                 3.00000000e-01
                 3.50000000e-01
                 4.00000000e-01
                 4.50000000e-01
                 5.00000000e-01
                 5.50000000e-01
                 6.00000000e-01
                 6.50000000e-01
                 7.00000000e-01
                 7.50000000e-01
                 8.00000000e-01
                 8.50000000e-01
                 9.00000000e-01
                 9.10000000e-01
                 9.20000000e-01
                 9.30000000e-01
                 9.40000000e-01
                 9.50000000e-01
                 9.60000000e-01
                 9.70000000e-01
                 9.80000000e-01
                 9.90000000e-01]
    D_vals   = [2.01123000e-11
              2.89114000e-11
              2.71037000e-11
              2.74466000e-11
              2.61772000e-11
              2.61772000e-11
              3.19478000e-11
              2.87816000e-11
              2.67446000e-11
              2.58866000e-11
              1.71398000e-11
              2.27413000e-11
              1.79788000e-11
              1.76419000e-11
              2.03727000e-11
              2.20768000e-11
              2.63963000e-11
              2.86781000e-11
              2.83959000e-11
              3.00856000e-11
              2.42081000e-11
              2.37529000e-11
              2.69750000e-11
              3.00593000e-11
              2.76894000e-11
              2.15842000e-11
              2.78480000e-11
              3.33128000e-11
              3.23533000e-11
              3.50073000e-11
              3.04341000e-11
              4.78998000e-11
              5.32477000e-11
              5.95440000e-11
              6.09085000e-11
              6.37308000e-11]

    # Interpolation with extrapolation beyond known range (linear)
    itp = LinearInterpolation(soc_vals, D_vals, extrapolation_bc=Line())

    D = itp(soc)  # D in [m²/s]

    return D


end


function computeJ0anodeDLR(soc)
    # soc values (dimensionless)
    soc_vals = [
        1.00e-02, 2.00e-02, 3.00e-02, 4.00e-02, 5.00e-02, 6.00e-02, 7.00e-02, 8.00e-02, 9.00e-02, 1.00e-01,
        1.50e-01, 2.00e-01, 2.50e-01, 3.00e-01, 3.50e-01, 4.00e-01, 4.50e-01, 5.00e-01, 5.50e-01, 6.00e-01,
        6.50e-01, 7.00e-01, 7.50e-01, 8.00e-01, 8.50e-01, 9.00e-01, 9.10e-01, 9.20e-01, 9.30e-01, 9.40e-01,
        9.50e-01, 9.60e-01, 9.70e-01, 9.80e-01, 9.90e-01, 1.00e+00
    ]

    # j0 values [A/m²] — converted from mA/cm² to A/m²: (mA / cm²) = (1e-3 A) / (1e-4 m²) = 10 A/m²
    j0_vals = [
        1.2368e-01, 1.3973e-01, 1.5420e-01, 1.6764e-01, 1.8238e-01, 1.9746e-01, 2.1179e-01, 2.2656e-01,
        2.3949e-01, 2.5654e-01, 2.7771e-01, 2.8392e-01, 2.8233e-01, 2.9194e-01, 2.9803e-01, 3.1078e-01,
        3.2650e-01, 3.3518e-01, 3.3640e-01, 3.4675e-01, 3.5691e-01, 3.6240e-01, 3.6337e-01, 3.7326e-01,
        3.7030e-01, 3.5927e-01, 3.6449e-01, 3.6586e-01, 3.6732e-01, 3.6639e-01, 3.6396e-01, 3.6279e-01,
        3.6093e-01, 3.5855e-01, 3.5868e-01, 3.5764e-01
    ] .* 10.0  # Convert mA/cm² → A/m²

    # Linear interpolator with extrapolation
    itp = LinearInterpolation(soc_vals, j0_vals, extrapolation_bc=Line())

    j0 = itp(soc)  # [A/m²]
    return j0
end


function computeJ0cathodeDLR(soc)
    soc_vals = [
        1.00e-02, 2.00e-02, 3.00e-02, 4.00e-02, 5.00e-02, 6.00e-02, 7.00e-02, 8.00e-02, 9.00e-02, 1.00e-01,
        1.50e-01, 2.00e-01, 2.50e-01, 3.00e-01, 3.50e-01, 4.00e-01, 4.50e-01, 5.00e-01, 5.50e-01, 6.00e-01,
        6.50e-01, 7.00e-01, 7.50e-01, 8.00e-01, 8.50e-01, 9.00e-01, 9.10e-01, 9.20e-01, 9.30e-01, 9.40e-01,
        9.50e-01, 9.60e-01, 9.70e-01, 9.80e-01, 9.90e-01, 1.00e+00
    ]

    # Conversion mA/cm² → A/m² = x10
    j0_vals = [
        2.586e-02, 2.549e-02, 2.701e-02, 3.178e-02, 3.461e-02, 4.041e-02, 3.647e-02, 3.944e-02, 3.996e-02, 5.038e-02,
        4.653e-02, 5.334e-02, 5.211e-02, 5.607e-02, 5.785e-02, 6.559e-02, 7.922e-02, 7.521e-02, 7.613e-02, 8.551e-02,
        9.251e-02, 9.923e-02, 9.324e-02, 8.021e-02, 7.196e-02, 5.783e-02, 4.651e-02, 5.072e-02, 4.478e-02, 5.087e-02,
        5.132e-02, 4.746e-02, 3.314e-02, 4.085e-02, 3.796e-02, 3.400e-02
    ] .* 10.0  # Convert mA/cm² to A/m²

    # Interpolation linéaire avec extrapolation
    itp = LinearInterpolation(soc_vals, j0_vals, extrapolation_bc=Line())
    j0 = itp(soc)
    return j0
end

function simpleComputeConductivityElectrolyteDLR(c, T)
    # Table des concentrations en mol/L
    c_vals = [1.00000000e-01
              2.00000000e-01
              3.00000000e-01
              4.00000000e-01
              5.00000000e-01
              6.00000000e-01
              7.00000000e-01
              8.00000000e-01
              9.00000000e-01
              1.00000000e+00
              1.10000000e+00
              1.20000000e+00
              1.30000000e+00
              1.40000000e+00
              1.50000000e+00
              1.60000000e+00
              1.70000000e+00
              1.80000000e+00
              1.90000000e+00
              2.00000000e+00
              2.10000000e+00
              2.20000000e+00
              2.30000000e+00
              2.40000000e+00
              2.50000000e+00
              2.60000000e+00
              2.70000000e+00
              2.80000000e+00
              2.90000000e+00
              3.00000000e+00
              3.10000000e+00
              3.20000000e+00
              3.30000000e+00
              3.40000000e+00
              3.50000000e+00
              3.60000000e+00
              3.70000000e+00
              3.80000000e+00
              3.90000000e+00
              4.00000000e+00]

    # Conductivité à 25°C en mS/cm, convertie en S/m si besoin
    kappa_vals = [2.64346516e+00 
                  4.64709517e+00 
                  6.18762003e+00 
                  7.38425487e+00 
                  8.31802287e+00 
                  9.04444737e+00 
                  9.60196460e+00 
                  1.00175475e+01 
                  1.03104934e+01 
                  1.04949894e+01 
                  1.05818583e+01 
                  1.05797463e+01 
                  1.04959317e+01 
                  1.03368717e+01 
                  1.01085687e+01 
                  9.81681232e+00 
                  9.46733538e+00 
                  9.06591040e+00 
                  8.61840634e+00 
                  8.13081812e+00 
                  7.60927837e+00 
                  7.06005781e+00 
                  6.48955867e+00 
                  5.90430424e+00 
                  5.31092652e+00 
                  4.71615334e+00 
                  4.12679575e+00 
                  3.54973624e+00 
                  2.99191795e+00 
                  2.46033517e+00 
                  1.96202490e+00 
                  1.50405963e+00 
                  1.09354115e+00 
                  7.37595285e-01 
                  4.43367486e-01 
                  2.18019168e-01 
                  6.87246458e-02 
                  2.66862349e-03 
                  2.70441342e-02 
                  1.49050857e-01 ]

    # Interpolateur linéaire avec extrapolation
    itp = get_1d_interpolator(c_vals, kappa_vals, cap_endpoints = false)

    # Évaluation de la conductivité
    kappa = itp(c)

    return kappa
end

function simpleComputeDiffusionCoefficientElectrolyteDLR(c, T)
    # Table des concentrations en mol/L
    c_vals = [
        0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
        1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0,
        2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0,
        3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0
    ] 

    # Coefficients de diffusion à 25°C en cm²/s
    D_vals = [ 7.03880320e-06  
               6.18695279e-06  
               5.49196313e-06  
               4.91554774e-06  
               4.42971043e-06  
               4.01380267e-06  
               3.65247534e-06  
               3.33423845e-06  
               3.05043776e-06  
               2.79452010e-06  
               2.56150076e-06  
               2.34757373e-06  
               2.14982385e-06  
               1.96601271e-06  
               1.79441809e-06  
               1.63371289e-06  
               1.48287339e-06  
               1.34110922e-06  
               1.20780993e-06  
               1.08250393e-06  
               9.64826913e-07  
               8.54497523e-07  
               7.51298563e-07  
               6.55062468e-07  
               5.65660060e-07  
               4.82991848e-07  
               4.06981288e-07  
               3.37569565e-07  
               2.74711546e-07  
               2.18372653e-07  
               1.68526442e-07  
               1.25152724e-07  
               8.82361241e-08  
               5.77649559e-08  
               3.37303641e-08  
               1.61256567e-08  
               4.94579393e-09  
               1.86994546e-10  
               1.84643366e-09  
               9.92201130e-09  ]

    # Interpolateur linéaire avec extrapolation
    itp = get_1d_interpolator(c_vals, D_vals, cap_endpoints = false)

    # Évaluation du coefficient de diffusion
    D = itp(c)

    return D
end

